From 2ff4bdb7992b228a569cd893646e2c68d887679c Mon Sep 17 00:00:00 2001
From: senquack <dansilsby@gmail.com>
Date: Fri, 16 Sep 2016 23:36:42 -0400
Subject: [PATCH] misc: Use faster 'level 4' zlib compression

---
 src/misc.cpp | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/src/misc.cpp b/src/misc.cpp
index dd875c7a..26a4982e 100644
--- a/src/misc.cpp
+++ b/src/misc.cpp
@@ -580,7 +580,13 @@ int Load(const char *ExePath) {
 // STATES
 static void *zlib_open(const char *name, const char *mode)
 {
-	return (void*)gzopen(name, mode);
+	// Default zlib compression level is 6, which is a bit slow.. 4 is faster:
+	const char* compr_level = "4";
+	char full_mode[12];
+	strncpy(full_mode, mode, 10);
+	full_mode[10] = '\0';
+	strcat(full_mode, compr_level);
+	return (void*)gzopen(name, full_mode);
 }
 
 static int zlib_read(void *file, void *buf, u32 len)
