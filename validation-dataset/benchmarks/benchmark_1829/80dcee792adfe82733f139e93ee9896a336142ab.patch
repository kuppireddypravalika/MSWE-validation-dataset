From 80dcee792adfe82733f139e93ee9896a336142ab Mon Sep 17 00:00:00 2001
From: Hiroshi Horii <horii@jp.ibm.com>
Date: Thu, 25 Oct 2018 22:58:47 +0900
Subject: [PATCH] use omp_get_max_threads instead of omp_get_num_procs

---
 src/base/controller.hpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/base/controller.hpp b/src/base/controller.hpp
index 081f1b460b..2222f935a2 100755
--- a/src/base/controller.hpp
+++ b/src/base/controller.hpp
@@ -269,7 +269,7 @@ json_t Controller::execute(const json_t &qobj_js) {
 
   // Check for OpenMP and number of available CPUs
   #ifdef _OPENMP
-    int omp_ncpus = std::max(1, omp_get_num_procs());
+    int omp_ncpus = std::max(1, omp_get_max_threads());
     omp_set_nested(1); // allow nested parallel threads for states
     available_threads_ = omp_ncpus;
     if (max_threads_total_ < 1)
