From 758f087663e00ddad9034344a579ec6bef024187 Mon Sep 17 00:00:00 2001
From: August Johansson <august@simula.no>
Date: Wed, 4 May 2016 23:05:57 +0200
Subject: [PATCH] Now use sort in comparison

---
 dolfin/geometry/CGALExactArithmetic.h | 11 ++++++++---
 1 file changed, 8 insertions(+), 3 deletions(-)

diff --git a/dolfin/geometry/CGALExactArithmetic.h b/dolfin/geometry/CGALExactArithmetic.h
index 7f5c13fd381..bdaf0f55d0a 100644
--- a/dolfin/geometry/CGALExactArithmetic.h
+++ b/dolfin/geometry/CGALExactArithmetic.h
@@ -100,8 +100,13 @@ namespace dolfin
     }
     else
     {
-      for (std::size_t i = 0; i < result_dolfin.size(); ++i)
-	if (!near(result_dolfin[i], result_cgal[i]))
+      std::vector<double> sorted_result_dolfin = result_dolfin;
+      std::sort(sorted_result_dolfin.begin(), sorted_result_dolfin.end());
+      std::vector<double> sorted_result_cgal = result_cgal;
+      std::sort(sorted_result_cgal.begin(), sorted_result_cgal.end());
+
+      for (std::size_t i = 0; i < sorted_result_dolfin.size(); ++i)
+	if (!near(sorted_result_dolfin[i], sorted_result_cgal[i]))
 	{
 	  std::stringstream s_dolfin;
 	  for (const double v: result_dolfin)
@@ -112,7 +117,7 @@ namespace dolfin
 	    s_cgal << v << ' ';
 
 	  dolfin_error("CGALExactArithmetic.h",
-		       "verify intersections due to different data",
+		       "verify intersections due to different data (NB: we sort data before comparing)",
 		       "Intersection function: %s\n DOLFIN: %s\n CGAL: %s",
 		       function.c_str(),
 		       s_dolfin.str().c_str(),
