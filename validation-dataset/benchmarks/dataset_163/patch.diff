From a1b1b07bf743e00be17eb55ccede5daac440d897 Mon Sep 17 00:00:00 2001
From: Hanna K <hanna.knutsson@protonmail.com>
Date: Sat, 10 Jun 2023 12:07:33 +0200
Subject: [PATCH] Do not calculate functions in arguments of functions that are
 not differentiable, after function calculation fails, before uncertainty
 calculation

---
 libqalculate/MathStructure-eval.cc | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/libqalculate/MathStructure-eval.cc b/libqalculate/MathStructure-eval.cc
index 14ee1483..453245fd 100644
--- a/libqalculate/MathStructure-eval.cc
+++ b/libqalculate/MathStructure-eval.cc
@@ -534,6 +534,8 @@ bool calculate_nondifferentiable_functions(MathStructure &m, const EvaluationOpt
 			if(m.calculateFunctions(eo, false, do_unformat)) {
 				if(recursive) calculate_nondifferentiable_functions(m, eo, recursive, do_unformat, i_type);
 				return true;
+			} else {
+				return false;
 			}
 		} else if(m.function()->id() == FUNCTION_ID_ABS && m.size() == 1) {
 			EvaluationOptions eo3 = eo;
