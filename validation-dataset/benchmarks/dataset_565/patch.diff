From 3460dba31db2bb4f3882850efb10b8005d3fd93e Mon Sep 17 00:00:00 2001
From: Kuba Ober <kuba@bertec.com>
Date: Tue, 12 May 2020 14:25:57 -0400
Subject: [PATCH] Get rid of manual memory management in
 GroupCell::ToTeXCodeCell.

---
 src/GroupCell.cpp | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)

diff --git a/src/GroupCell.cpp b/src/GroupCell.cpp
index ed8146ceba..c6345b67c5 100644
--- a/src/GroupCell.cpp
+++ b/src/GroupCell.cpp
@@ -1551,16 +1551,16 @@ wxString GroupCell::ToTeXCodeCell(wxString imgDir, wxString filename, int *imgCo
   {
     // For LaTeX export we must use a dot as decimal separator
     // Save LC_NUMERIC, set it to "C", print out the float and then restore it.
-    char* saved_lc_numeric = strdup(setlocale(LC_NUMERIC, NULL)); // get current LC_NUMERIC locale
+    const std::string saved_lc_numeric{setlocale(LC_NUMERIC, NULL)}; // get current LC_NUMERIC locale
     setlocale(LC_NUMERIC, "C");
     str += wxString::Format(
       "\n\n\\noindent\n%%%%%%%%%%%%%%%\n%%% INPUT:\n\\begin{minipage}[t]{%fem}\\color{red}\\bfseries\n",
       (double)configuration->GetLabelWidth()/14
       ) + m_inputLabel->ToTeX() +
       wxString("\n\\end{minipage}");
-    setlocale(LC_NUMERIC, saved_lc_numeric);
-    free(saved_lc_numeric);
-    if (m_inputLabel->m_next != NULL)
+    setlocale(LC_NUMERIC, saved_lc_numeric.c_str());
+
+    if (m_inputLabel->m_next)
     {
 
       wxString input = m_inputLabel->m_next->ToTeX();
