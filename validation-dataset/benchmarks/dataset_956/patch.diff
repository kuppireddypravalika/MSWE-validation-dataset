From 718e312eadaedd9d255afb398c7d560c40598609 Mon Sep 17 00:00:00 2001
From: David Korth <gerbilsoft@gerbilsoft.com>
Date: Sat, 7 Jan 2017 15:24:58 -0500
Subject: [PATCH] [libromdata] RpWin32.hpp: New macro W2RP_cl().

This takes a const wchar_t* and length. For RP_UTF16, the length isn't
used. For RP_UTF8, the length is used as an optimization.
---
 src/libromdata/RpWin32.hpp | 22 ++++++++++++++++++++++
 1 file changed, 22 insertions(+)

diff --git a/src/libromdata/RpWin32.hpp b/src/libromdata/RpWin32.hpp
index d028ba26fa..cd0ffc251a 100644
--- a/src/libromdata/RpWin32.hpp
+++ b/src/libromdata/RpWin32.hpp
@@ -84,6 +84,16 @@ int w32err_to_posix(DWORD w32err);
 	(LibRomData::utf16_to_rp_string( \
 		reinterpret_cast<const char16_t*>(wcs), -1).c_str())
 
+/**
+ * Get const rp_char* from const wchar_t*.
+ * @param wcs const wchar_t*
+ * @param len Length of wcs.
+ * @return const rp_char*
+ */
+#define W2RP_cl(wcs, len) \
+	(LibRomData::utf16_to_rp_string( \
+		reinterpret_cast<const char16_t*>(wcs), len).c_str())
+
 /**
  * Get const rp_char* from std::wstring.
  * @param wcs std::wstring
@@ -145,6 +155,18 @@ static inline const rp_char *W2RP_c(const wchar_t *wcs)
 	return reinterpret_cast<const rp_char*>(wcs);
 }
 
+/**
+ * Get const rp_char* from const wchar_t*.
+ * @param wcs const wchar_t*
+ * @param len Length of wcs.
+ * @return const rp_char*
+ */
+static inline const rp_char *W2RP_cl(const wchar_t *wcs, int len)
+{
+	((void)len);
+	return reinterpret_cast<const rp_char*>(wcs);
+}
+
 /**
  * Get const rp_char* from std::wstring.
  * @param wcs std::wstring
