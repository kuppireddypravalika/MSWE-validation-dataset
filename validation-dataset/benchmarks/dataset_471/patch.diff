From 5198df5c25acfe2635d5d2999a7592ec48e11b0a Mon Sep 17 00:00:00 2001
From: Matt <m.moninger.h@gmail.com>
Date: Sat, 11 May 2019 22:38:57 +0200
Subject: [PATCH] Improve generation of random advertisment key

---
 src/openrct2/network/NetworkServerAdvertiser.cpp | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/src/openrct2/network/NetworkServerAdvertiser.cpp b/src/openrct2/network/NetworkServerAdvertiser.cpp
index 1b8623bfb426..cf903987535e 100644
--- a/src/openrct2/network/NetworkServerAdvertiser.cpp
+++ b/src/openrct2/network/NetworkServerAdvertiser.cpp
@@ -27,6 +27,7 @@
 
 #    include <iterator>
 #    include <memory>
+#    include <random>
 #    include <string>
 
 #    ifndef DISABLE_HTTP
@@ -241,10 +242,14 @@ class NetworkServerAdvertiser final : public INetworkServerAdvertiser
         static constexpr char hexChars[] = {
             '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f',
         };
+
+        std::random_device rd;
+        std::uniform_int_distribution<> dist(0, std::size(hexChars) - 1);
+
         char key[17];
         for (int32_t i = 0; i < 16; i++)
         {
-            int32_t hexCharIndex = util_rand() % std::size(hexChars);
+            int32_t hexCharIndex = dist(rd);
             key[i] = hexChars[hexCharIndex];
         }
         key[std::size(key) - 1] = 0;
