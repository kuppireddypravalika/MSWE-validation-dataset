From 118e5de18e6afef3c9cb3a2a4a0d7c8724e7e316 Mon Sep 17 00:00:00 2001
From: DaeHee-Cho <cdh0012@inveniacorp.com>
Date: Fri, 22 Nov 2019 17:16:52 +0900
Subject: [PATCH] Change Optimizer  - Adam -> SGD

---
 .../SemanticSegmentation-Libtorch.cpp                        | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/SemanticSegmentation-Libtorch/SemanticSegmentation-Libtorch.cpp b/SemanticSegmentation-Libtorch/SemanticSegmentation-Libtorch.cpp
index e416e9f..3eaf0f4 100644
--- a/SemanticSegmentation-Libtorch/SemanticSegmentation-Libtorch.cpp
+++ b/SemanticSegmentation-Libtorch/SemanticSegmentation-Libtorch.cpp
@@ -5,7 +5,7 @@
 #include <chrono>
 
 torch::DeviceType device_type;
-const int64_t kTrainBatchSize = 6;
+const int64_t kTrainBatchSize = 8;
 using namespace std;
 
 void genarateColormap(std::vector<cv::Scalar>& map, int64_t numclass)
@@ -97,7 +97,8 @@ void training()
 		}
 	}
 
-	torch::optim::Adam optimizer(trainable_params, torch::optim::AdamOptions(1e-3 /*learning rate*/));
+	//::optim::Adam optimizer(trainable_params, torch::optim::AdamOptions(1e-3 /*learning rate*/));
+	torch::optim::SGD optimizer(trainable_params, torch::optim::SGDOptions(0.01 /*learning rate*/).momentum(0.9).weight_decay(1e-4));
 
 	std::map<std::string, torch::Tensor> loss_map;
 	std::chrono::duration<double> data_time, batch_time;
