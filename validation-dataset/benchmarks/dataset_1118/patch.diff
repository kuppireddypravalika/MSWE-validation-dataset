From 8b37ec963e77eecb0616b039e6610039d7191a9c Mon Sep 17 00:00:00 2001
From: Even Rouault <even.rouault@mines-paris.org>
Date: Thu, 4 Dec 2014 23:53:17 +0000
Subject: [PATCH] Small optimization/code simplification in
 GDALRasterBand::Fill()

git-svn-id: https://svn.osgeo.org/gdal/trunk@28070 f0d54148-0727-0410-94bb-9a71ac55c965
---
 gdal/gcore/gdalrasterband.cpp | 11 +++--------
 1 file changed, 3 insertions(+), 8 deletions(-)

diff --git a/gdal/gcore/gdalrasterband.cpp b/gdal/gcore/gdalrasterband.cpp
index 1367642634f7..10225eaaa005 100644
--- a/gdal/gcore/gdalrasterband.cpp
+++ b/gdal/gcore/gdalrasterband.cpp
@@ -1366,15 +1366,10 @@ CPLErr GDALRasterBand::Fill(double dfRealValue, double dfImaginaryValue) {
         return CE_Failure;
     }
     
-    // Initialize the first element of the block, doing type conversion
+    // Initialize the source block
     double complexSrc[2] = { dfRealValue, dfImaginaryValue };
-    GDALCopyWords(complexSrc, GDT_CFloat64, 0, srcBlock, eDataType, 0, 1);
-
-    // Copy first element to the rest of the block
-    for (unsigned char* blockPtr = srcBlock + elementSize; 
-	 blockPtr < srcBlock + blockByteSize; blockPtr += elementSize) {
-	memcpy(blockPtr, srcBlock, elementSize);
-    }
+    GDALCopyWords(complexSrc, GDT_CFloat64, 0,
+                  srcBlock, eDataType, elementSize, blockSize);
 
     // Write block to block cache
     for (int j = 0; j < nBlocksPerColumn; ++j) {
