From 9cdd1319adffd56bbe7676447ee0d2ae1d63a21f Mon Sep 17 00:00:00 2001
From: pk <pk@valec.net>
Date: Sun, 21 Oct 2018 17:39:18 +0200
Subject: [PATCH] Fixed OMP for matrix.rms()

---
 psi4/src/psi4/libmints/matrix.cc | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/psi4/src/psi4/libmints/matrix.cc b/psi4/src/psi4/libmints/matrix.cc
index 34955e5e4d6..ddaaa5e245e 100644
--- a/psi4/src/psi4/libmints/matrix.cc
+++ b/psi4/src/psi4/libmints/matrix.cc
@@ -1251,7 +1251,7 @@ double Matrix::rms() {
     double sum = (double)0.0;
     long terms = 0;
     for (int h = 0; h < nirrep_; ++h) {
-#pragma omp parallel for reduction(+ : sum)
+#pragma omp parallel for reduction(+ : sum, terms)
         for (int i = 0; i < rowspi_[h]; ++i) {
             for (int j = 0; j < colspi_[h ^ symmetry_]; ++j) {
                 sum += matrix_[h][i][j] * matrix_[h][i][j];
