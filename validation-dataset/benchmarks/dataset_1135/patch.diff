From ba78c25fad0b8e6ba75da566e03cc4c5836b4cfd Mon Sep 17 00:00:00 2001
From: Even Rouault <even.rouault@mines-paris.org>
Date: Sat, 2 Jan 2016 15:55:26 +0000
Subject: [PATCH] OpenAIR: avoid int32 overflow

git-svn-id: https://svn.osgeo.org/gdal/trunk@32678 f0d54148-0727-0410-94bb-9a71ac55c965
---
 gdal/ogr/ogrsf_frmts/openair/ogropenairdatasource.cpp | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/gdal/ogr/ogrsf_frmts/openair/ogropenairdatasource.cpp b/gdal/ogr/ogrsf_frmts/openair/ogropenairdatasource.cpp
index fbf8be5c691f..e72b559abb6c 100644
--- a/gdal/ogr/ogrsf_frmts/openair/ogropenairdatasource.cpp
+++ b/gdal/ogr/ogrsf_frmts/openair/ogropenairdatasource.cpp
@@ -124,7 +124,7 @@ int OGROpenAirGetLatLon(const char* pszStr, double& dfLat, double& dfLon)
     dfLat = 0;
     dfLon = 0;
 
-    int nCurInt = 0;
+    GUIntBig nCurInt = 0;
     double dfExp = 1.;
     int bHasExp = FALSE;
     int nCurPart = DEGREE;
@@ -135,7 +135,9 @@ int OGROpenAirGetLatLon(const char* pszStr, double& dfLat, double& dfLon)
     {
         if (c >= '0' && c <= '9')
         {
-            nCurInt = nCurInt * 10 + c - '0';
+            nCurInt = nCurInt * 10U + (unsigned char)c - '0';
+            if( nCurInt >> 60 ) // to avoid uint64 overflow at next iteration
+                return FALSE;
             if (bHasExp)
                 dfExp *= 10;
         }
