From c30d290f5db18335d842d55b984a684eb5487313 Mon Sep 17 00:00:00 2001
From: "emery.berger@gmail.com" <emery.berger@gmail.com>
Date: Fri, 8 Jan 2021 13:34:14 -0500
Subject: [PATCH] Removed unused (and costly) calls to backtrace_symbols.

---
 libcheaper.cpp | 8 ++------
 1 file changed, 2 insertions(+), 6 deletions(-)

diff --git a/libcheaper.cpp b/libcheaper.cpp
index c3411ae..bede17c 100644
--- a/libcheaper.cpp
+++ b/libcheaper.cpp
@@ -97,19 +97,15 @@ static std::atomic<bool> firstDone{false};
 
 static void printStack() {
   void *callstack[MAX_STACK_LENGTH];
-  char buf[256 * MAX_STACK_LENGTH];
   busy++;
   auto nframes = backtrace(callstack, MAX_STACK_LENGTH);
-  char **syms = backtrace_symbols(callstack, nframes);
   busy--;
-  char *b = buf;
   // JSON doesn't allow trailing commas at the end,
-  // which is stupid, but we have to deal with it.
+  // which is stupid, but we have to deal with it. 
   for (auto i = 0; i < nframes - 1; i++) {
-    tprintf::tprintf("@, ", (uintptr_t)callstack[i]);
+   tprintf::tprintf("@, ", (uintptr_t)callstack[i]);
   }
   tprintf::tprintf("@", (uintptr_t)callstack[nframes - 1]);
-  getTheCustomHeap().free(syms);
 }
 
 static bool printProlog(char action) {
