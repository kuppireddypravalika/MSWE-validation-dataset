From a2976f4ce10ab4434450754825cc391a1e6ac680 Mon Sep 17 00:00:00 2001
From: Jeff Trull <edaskel@att.net>
Date: Sat, 7 Feb 2015 15:54:16 -0800
Subject: [PATCH] change QR to LU factorization for solves in PRIMA code due to
 experimental observation of improved sparsity in result

---
 analysis/prima.hpp | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/analysis/prima.hpp b/analysis/prima.hpp
index 7408c9f..d77581a 100644
--- a/analysis/prima.hpp
+++ b/analysis/prima.hpp
@@ -21,6 +21,7 @@
 #include <vector>
 #include <Eigen/Dense>
 #include <Eigen/SparseQR>
+#include <Eigen/SparseLU>
 
 namespace EDASkel {
 namespace analysis {
@@ -57,7 +58,7 @@ Prima(Eigen::SparseMatrix<Float> const& C,   // derivative conductance terms
   // Step 1 of PRIMA creates the B and L matrices, and is performed by the caller.
 
   // Step 2: Solve GR = B for R
-  SparseQR<SparseMatrix<Float>, COLAMDOrdering<int> > G_QR(G);
+  SparseLU<SparseMatrix<Float>, COLAMDOrdering<int> > G_QR(G);
   assert(G_QR.info() == Success);
   SparseMatrix<Float> R = G_QR.solve(B);
   assert(G_QR.info() == Success);
