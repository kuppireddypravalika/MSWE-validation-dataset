From 4de546909841ed061bfbc6cd856836b3c46069d9 Mon Sep 17 00:00:00 2001
From: Tobias Ludwig <tludwig@inf.fu-berlin.de>
Date: Fri, 17 Oct 2014 13:51:50 +0200
Subject: [PATCH] ParticleFishTracker.cpp : avoid unnecessary vector copy

---
 .../tracking/algorithm/fishparticle/ParticleFishTracker.cpp | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/source/tracking/algorithm/fishparticle/ParticleFishTracker.cpp b/source/tracking/algorithm/fishparticle/ParticleFishTracker.cpp
index e615aba5..9aaa0ed5 100644
--- a/source/tracking/algorithm/fishparticle/ParticleFishTracker.cpp
+++ b/source/tracking/algorithm/fishparticle/ParticleFishTracker.cpp
@@ -4,6 +4,8 @@
 
 #include "particlefilter/ParticleBrightnessObserver.h"
 
+#include <utility> // std::move
+
 
 static bool compareReverseParticleScorePredicate(const Particle& p1, const Particle& p2);
 
@@ -77,9 +79,9 @@ void ParticleFishTracker::track( unsigned long, cv::Mat& frame) {
 */
 void ParticleFishTracker::importanceResample() {
 	// Make a copy and generate new particles.
-	std::vector<Particle> old_particles = _current_particles;
-	size_t random_new_particles = _current_particles.size() * 0.01;
+	size_t random_new_particles = _current_particles.size() / 100;
 	std::vector<unsigned> cluster_counts(_clusters.centers().rows);
+	std::vector<Particle> old_particles = std::move(_current_particles);
 	_current_particles.clear();
 
 	for (size_t i = 0; i < old_particles.size()-random_new_particles; i++) {
