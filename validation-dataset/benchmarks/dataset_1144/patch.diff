From e6119e750911a0af50a7af456f8af3995d5e634e Mon Sep 17 00:00:00 2001
From: Frank Warmerdam <warmerdam@pobox.com>
Date: Mon, 25 Apr 2005 22:26:46 +0000
Subject: [PATCH] avoid extra copy if we are loading into the cache block in
 IReadBlock

git-svn-id: https://svn.osgeo.org/gdal/trunk@7523 f0d54148-0727-0410-94bb-9a71ac55c965
---
 frmts/vrt/vrtwarped.cpp | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/frmts/vrt/vrtwarped.cpp b/frmts/vrt/vrtwarped.cpp
index 136b6318cf04..76218570e18d 100644
--- a/frmts/vrt/vrtwarped.cpp
+++ b/frmts/vrt/vrtwarped.cpp
@@ -28,6 +28,9 @@
  ******************************************************************************
  *
  * $Log$
+ * Revision 1.9  2005/04/25 22:26:46  fwarmerdam
+ * avoid extra copy if we are loading into the cache block in IReadBlock
+ *
  * Revision 1.8  2005/04/11 17:36:26  fwarmerdam
  * make sure we cleanup up transformer(s) too
  *
@@ -933,7 +936,7 @@ CPLErr VRTWarpedRasterBand::IReadBlock( int nBlockXOff, int nBlockYOff,
 
     eErr = poWDS->ProcessBlock( nBlockXOff, nBlockYOff );
 
-    if( eErr == CE_None )
+    if( eErr == CE_None && pImage != poBlock->GetDataRef() )
     {
         int nDataBytes;
         nDataBytes = (GDALGetDataTypeSize(poBlock->GetDataType()) / 8)
