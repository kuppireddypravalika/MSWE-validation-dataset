From 3b85131ca5f62a4442d1e51a9836bc0a1b66f8f9 Mon Sep 17 00:00:00 2001
From: Marcel Schneider <marcel@coopmasters.de>
Date: Mon, 6 May 2019 17:40:43 +0200
Subject: [PATCH] emplace_back returns a reference to the emplaced element

one less copy
---
 csv2xlslib/callback.cpp | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/csv2xlslib/callback.cpp b/csv2xlslib/callback.cpp
index 4a193f6..6d56be4 100644
--- a/csv2xlslib/callback.cpp
+++ b/csv2xlslib/callback.cpp
@@ -43,8 +43,8 @@ void csv_cb_headline_field(void *s, size_t len, void *data)
 
     if (XLS_MAX_COLUMNS.Get() >= xls_file.headline.size())
     {
-        appendCell(xls_file, CellContent(csv_field));
-        xls_file.headline.emplace_back(std::string(csv_field, len));
+        auto const& cell_content = xls_file.headline.emplace_back(std::string(csv_field, len));
+        appendCell(xls_file, cell_content);
     }
 }
 
