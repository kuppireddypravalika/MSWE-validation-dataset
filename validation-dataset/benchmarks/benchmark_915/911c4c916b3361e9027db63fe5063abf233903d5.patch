From 911c4c916b3361e9027db63fe5063abf233903d5 Mon Sep 17 00:00:00 2001
From: Adam Lackorzynski <adam@l4re.org>
Date: Mon, 7 Aug 2023 00:00:00 +0000
Subject: [PATCH] Vfs::mmap2: Reduce truncing and rounding

size and offset are already page aligned, so
do not do it again.

Change-Id: I605338a49ef5dde56760cfc66cfd13e9c13b3eae
---
 l4re_vfs/include/impl/vfs_impl.h | 3 +--
 1 file changed, 1 insertion(+), 2 deletions(-)

diff --git a/l4re_vfs/include/impl/vfs_impl.h b/l4re_vfs/include/impl/vfs_impl.h
index 79d04b058..22abd86d6 100644
--- a/l4re_vfs/include/impl/vfs_impl.h
+++ b/l4re_vfs/include/impl/vfs_impl.h
@@ -585,8 +585,7 @@ Vfs::mmap2(void *start, size_t len, int prot, int flags, int fd, off_t page4k_of
       if (flags & MAP_PRIVATE)
 	{
 	  DEBUG_LOG(debug_mmap, outstring("COW\n"););
-          int err = ds->copy_in(anon_offset, fds, l4_trunc_page(offset),
-                                l4_round_page(size));
+          int err = ds->copy_in(anon_offset, fds, offset, size);
           if (err < 0)
             return err;
 
