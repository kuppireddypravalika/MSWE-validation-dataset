From 3b76b3619d2d1bb581fe82fede36e0bf0599ed81 Mon Sep 17 00:00:00 2001
From: Josh Morman <jmorman@gnuradio.org>
Date: Mon, 14 Feb 2022 13:19:41 -0500
Subject: [PATCH] bench: msg_forward initialize before preloading

Signed-off-by: Josh Morman <jmorman@gnuradio.org>
---
 bench/bm_msg_forward.cc | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/bench/bm_msg_forward.cc b/bench/bm_msg_forward.cc
index fb7c5505..7554c491 100644
--- a/bench/bm_msg_forward.cc
+++ b/bench/bm_msg_forward.cc
@@ -55,7 +55,8 @@ int main(int argc, char* argv[])
             fg->connect(msg_blks[i-1], "out", msg_blks[i], "in");
         }
 
-        fg->validate();
+        auto rt = runtime::make();
+        rt->initialize(fg);
 
         for(size_t p = 0; p < samples; p++) {
             pmtf::pmt msg = pmtf::vector<uint8_t>(pdu_size, 0x42);
@@ -66,8 +67,7 @@ int main(int argc, char* argv[])
         // std::this_thread::sleep_for(std::chrono::seconds(3));
         auto t1 = std::chrono::steady_clock::now();
 
-        auto rt = runtime::make();
-        rt->initialize(fg);
+
         rt->start();
         rt->wait();
 
