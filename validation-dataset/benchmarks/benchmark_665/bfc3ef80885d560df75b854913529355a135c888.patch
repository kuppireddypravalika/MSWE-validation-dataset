From bfc3ef80885d560df75b854913529355a135c888 Mon Sep 17 00:00:00 2001
From: Paul Baltescu <pauldb89@gmail.com>
Date: Wed, 23 Jul 2014 15:16:01 +0100
Subject: [PATCH] Use unrestricted permissions in shared memory.

---
 src/lbl/process_identifier.cc | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/src/lbl/process_identifier.cc b/src/lbl/process_identifier.cc
index 3f20d7f..6b64ade 100644
--- a/src/lbl/process_identifier.cc
+++ b/src/lbl/process_identifier.cc
@@ -7,7 +7,9 @@ namespace oxlm {
 const int ProcessIdentifier::MAX_PROCESS_ID = 1000;
 
 ProcessIdentifier::ProcessIdentifier(const char* segment_name) {
-  segment = SharedMemory(ip::open_or_create, segment_name, 1 << 16);
+  ip::permissions perm;
+  perm.set_unrestricted();
+  segment = SharedMemory(ip::open_or_create, segment_name, 1 << 16, 0, perm);
   processIds = segment.find_or_construct<ProcessIdSet>("ProcessIds")
       (0, boost::hash<int>(), equal_to<int>(), segment.get_allocator<int>());
   mutex = segment.find_or_construct<SharedMutex>("Mutex")();
