From b9380c940967b8d4404c366b580478360eb153e9 Mon Sep 17 00:00:00 2001
From: Edwig Huisman <edwig.huisman@hetnet.nl>
Date: Mon, 7 Feb 2022 14:42:15 +0100
Subject: [PATCH] Performance fix for developers.

---
 Marlin/HTTPClient.cpp | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/Marlin/HTTPClient.cpp b/Marlin/HTTPClient.cpp
index 4192f4a7..952d655e 100644
--- a/Marlin/HTTPClient.cpp
+++ b/Marlin/HTTPClient.cpp
@@ -2758,6 +2758,14 @@ HTTPClient::Send()
     LogTheSend(server,port);
   }
 
+  // Check on localhost for development systems.
+  // IIS has a problem to service 'localhost' directly and can lead
+  // to system 'hangs' for up to 8 seconds.
+  if(_wcsicmp(server.c_str(),L"localhost") == 0)
+  {
+    server = L"127.0.0.1";
+  }
+
   // First: do the connection to the server:port pair
   // Connection could have been opened by earlier Send
   if(m_connect == NULL)
