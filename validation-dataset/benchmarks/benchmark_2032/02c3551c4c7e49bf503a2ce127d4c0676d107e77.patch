From 02c3551c4c7e49bf503a2ce127d4c0676d107e77 Mon Sep 17 00:00:00 2001
From: Alexander Neundorf <neundorf@kde.org>
Date: Fri, 13 May 2005 15:19:28 +0000
Subject: [PATCH] -special optimization for makefiles generated by the cmake
 makefile generator version 2 and 3: only parse half as much files

Alex
---
 buildtools/custommakefiles/customprojectpart.cpp | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/buildtools/custommakefiles/customprojectpart.cpp b/buildtools/custommakefiles/customprojectpart.cpp
index 57f482c402f..36f418c545d 100644
--- a/buildtools/custommakefiles/customprojectpart.cpp
+++ b/buildtools/custommakefiles/customprojectpart.cpp
@@ -812,7 +812,12 @@ void CustomProjectPart::parseMakefile(const QString& filename)
 
       if (includedMakefilesRe.search(str) != -1)
       {
-         m_makefilesToParse.push(includedMakefilesRe.cap(1).simplifyWhiteSpace());
+         QString includedMakefile=includedMakefilesRe.cap(1).simplifyWhiteSpace();
+         /*special optimization for makefiles generated with the new cmake makefile generator:
+          it creates a tiny makefile for each object and a tiny dependency file for each object,
+          these dependency files can be skipped here, Alex */
+         if (!includedMakefile.endsWith(".depends.make"))
+            m_makefilesToParse.push(includedMakefile);
       }
       else if (re.search(str) != -1)
       {
