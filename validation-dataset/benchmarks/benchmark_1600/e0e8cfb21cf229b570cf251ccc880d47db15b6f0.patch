From e0e8cfb21cf229b570cf251ccc880d47db15b6f0 Mon Sep 17 00:00:00 2001
From: Baptiste Wicht <baptiste.wicht@gmail.com>
Date: Fri, 20 May 2016 15:04:09 +0200
Subject: [PATCH] Save some compilation time

---
 include/etl/evaluator.hpp | 18 +++++++++++++++---
 1 file changed, 15 insertions(+), 3 deletions(-)

diff --git a/include/etl/evaluator.hpp b/include/etl/evaluator.hpp
index cbbcd27ba..ceac578a4 100644
--- a/include/etl/evaluator.hpp
+++ b/include/etl/evaluator.hpp
@@ -644,14 +644,26 @@ namespace standard_evaluator {
      * \param expr The right hand side expression
      * \param result The left hand side
      */
-    template <typename E, typename R, cpp_disable_if(is_temporary_expr<E>::value)>
+    template <typename E, typename R, cpp_enable_if(!is_temporary_expr<E>::value && decay_traits<E>::is_linear)>
     void assign_evaluate(E&& expr, R&& result) {
         //Evaluate sub parts, if any
         pre_assign(expr);
 
-        constexpr bool linear = decay_traits<E>::is_linear;
+        //Perform the real evaluation, selected by TMP
+        assign_evaluate_impl(expr, result);
 
-        if(!linear && result.alias(expr)){
+        post_assign(expr, result);
+    }
+
+    /*!
+     * \copydoc assign_evaluate
+     */
+    template <typename E, typename R, cpp_enable_if(!is_temporary_expr<E>::value && !decay_traits<E>::is_linear)>
+    void assign_evaluate(E&& expr, R&& result) {
+        //Evaluate sub parts, if any
+        pre_assign(expr);
+
+        if(result.alias(expr)){
             auto tmp_result = force_temporary(result);
 
             //Perform the evaluation to tmp_result
