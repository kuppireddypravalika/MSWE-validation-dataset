From c3ef5624b9a2f98500e2b4b55563a2dc3d281df9 Mon Sep 17 00:00:00 2001
From: John Criswell <criswell@uiuc.edu>
Date: Fri, 7 Oct 2011 15:42:13 +0000
Subject: [PATCH] Removed atomic and memory fencing intrinsics as they've been
 replaced with real LLVM instructions.

git-svn-id: https://llvm.org/svn/llvm-project/poolalloc/trunk@141364 91177308-0d34-0410-b5e6-96231b3b80d8
---
 lib/DSA/Local.cpp | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/lib/DSA/Local.cpp b/lib/DSA/Local.cpp
index a1eaa007..17e1cae3 100644
--- a/lib/DSA/Local.cpp
+++ b/lib/DSA/Local.cpp
@@ -858,8 +858,6 @@ bool GraphBuilder::visitIntrinsic(CallSite CS, Function *F) {
       ->foldNodeCompletely();
     return true;
   case Intrinsic::vaend:
-  case Intrinsic::memory_barrier:
-    return true;  // noop
   case Intrinsic::memcpy: 
   case Intrinsic::memmove: {
     // Merge the first & second arguments, and mark the memory read and
@@ -904,6 +902,7 @@ bool GraphBuilder::visitIntrinsic(CallSite CS, Function *F) {
     return true;
   }
 
+#if 0
   case Intrinsic::atomic_cmp_swap: {
     DSNodeHandle Ptr = getValueDest(*CS.arg_begin());
     Ptr.getNode()->setReadMarker();
@@ -932,6 +931,7 @@ bool GraphBuilder::visitIntrinsic(CallSite CS, Function *F) {
       if (isa<PointerType>(F->getReturnType()))
         setDestTo(*CS.getInstruction(), getValueDest(*(CS.arg_begin() + 1)));
     }
+#endif
 
 
 
