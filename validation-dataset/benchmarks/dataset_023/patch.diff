From 33c36a32983a3cce7e33f95907d954401e5a07a7 Mon Sep 17 00:00:00 2001
From: Thomas Goyne <plorkyeran@aegisub.org>
Date: Fri, 18 May 2012 01:58:35 +0000
Subject: [PATCH] Fix double multiplication by sample rate that resulted in the
 waveform renderer allocating way more memory than needed

Originally committed to SVN as r6815.
---
 aegisub/src/audio_renderer_waveform.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/aegisub/src/audio_renderer_waveform.cpp b/aegisub/src/audio_renderer_waveform.cpp
index adbceb82c..db575e3c5 100644
--- a/aegisub/src/audio_renderer_waveform.cpp
+++ b/aegisub/src/audio_renderer_waveform.cpp
@@ -92,7 +92,7 @@ void AudioWaveformRenderer::Render(wxBitmap &bmp, int start, AudioRenderingStyle
 	if (!audio_buffer)
 	{
 		// Buffer for one pixel strip of audio
-		size_t buffer_needed = pixel_samples * provider->GetChannels() * provider->GetSampleRate() * provider->GetBytesPerSample();
+		size_t buffer_needed = pixel_samples * provider->GetChannels() * provider->GetBytesPerSample();
 		audio_buffer = new char[buffer_needed];
 	}
 
