From a7e9efebbb1d3eb6a67e370c3e0b626100c8a97e Mon Sep 17 00:00:00 2001
From: hess <hess>
Date: Tue, 17 Aug 2004 12:47:39 +0000
Subject: [PATCH] Changed Vexcl to double precision, previously there was a
 relatively large error in the PME energy in single precision

---
 src/gmxlib/ewald_util.c | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/gmxlib/ewald_util.c b/src/gmxlib/ewald_util.c
index f8c73d02d8..7ca2eb5945 100644
--- a/src/gmxlib/ewald_util.c
+++ b/src/gmxlib/ewald_util.c
@@ -88,8 +88,8 @@ real ewald_LRcorrection(FILE *fp,t_nsborder *nsb,t_commrec *cr,t_forcerec *fr,
   real Vself;
   int     i,i1,i2,j,k,m,iv,jv;
   atom_id *AA;
-  double  q2sum; /* Necessary for precision */
-  real    vc,qi,dr,dr2,rinv,fscal,Vexcl,Vcharge,Vdipole,rinv2,ewc=fr->ewaldcoeff;
+  double  q2sum,Vexcl; /* Necessary for precision */
+  real    vc,qi,dr,dr2,rinv,fscal,Vcharge,Vdipole,rinv2,ewc=fr->ewaldcoeff;
   rvec    df,dx,mutot,dipcorr;
   rvec    *f=fr->f_el_recip;
   real    vol = box[XX][XX]*box[YY][YY]*box[ZZ][ZZ];
