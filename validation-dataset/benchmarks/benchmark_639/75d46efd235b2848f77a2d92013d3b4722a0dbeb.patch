From 75d46efd235b2848f77a2d92013d3b4722a0dbeb Mon Sep 17 00:00:00 2001
From: Max Kellermann <max@duempel.org>
Date: Fri, 6 Nov 2015 09:47:28 +0100
Subject: [PATCH] util/UriUtil: use StringAfterPrefix() instead of memcmp()

---
 src/util/UriUtil.cxx | 18 +++++++++---------
 1 file changed, 9 insertions(+), 9 deletions(-)

diff --git a/src/util/UriUtil.cxx b/src/util/UriUtil.cxx
index 44b3e53ab8..f9dba97afc 100644
--- a/src/util/UriUtil.cxx
+++ b/src/util/UriUtil.cxx
@@ -18,6 +18,7 @@
  */
 
 #include "UriUtil.hxx"
+#include "StringCompare.hxx"
 
 #include <assert.h>
 #include <string.h>
@@ -108,15 +109,14 @@ gcc_pure
 static const char *
 SkipUriScheme(const char *uri)
 {
-	if (memcmp(uri, "http://", 7) == 0)
-		return uri + 7;
-	else if (memcmp(uri, "https://", 8) == 0)
-		return uri + 8;
-	else if (memcmp(uri, "ftp://", 6) == 0)
-		return uri + 6;
-	else
-		/* unrecognized URI */
-		return nullptr;
+	const char *const schemes[] = { "http://", "https://", "ftp://" };
+	for (auto scheme : schemes) {
+		auto result = StringAfterPrefix(uri, scheme);
+		if (result != nullptr)
+			return result;
+	}
+
+	return nullptr;
 }
 
 std::string
