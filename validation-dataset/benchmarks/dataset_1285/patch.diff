From ab79cef006eecf07682a3ade2902c660e5b68024 Mon Sep 17 00:00:00 2001
From: "K.Ohta" <whatisthis.sowhat@gmail.com>
Date: Tue, 10 Sep 2024 15:40:20 +0900
Subject: [PATCH] [OSD][Qt][SOUND] - Use std::unique_ptr<uint8_t>foo(new
 unit8_t[bytes]) instead of new uint8_t[bytes] .

---
 source/src/qt/osd_sound.cpp | 9 ++++-----
 1 file changed, 4 insertions(+), 5 deletions(-)

diff --git a/source/src/qt/osd_sound.cpp b/source/src/qt/osd_sound.cpp
index 27615eb74..74d2c8572 100644
--- a/source/src/qt/osd_sound.cpp
+++ b/source/src/qt/osd_sound.cpp
@@ -499,11 +499,10 @@ void OSD_BASE::put_null_sound()
 		//sound_drv->mute_sink();
 		size_t chunk_bytes = sound_drv->get_sink_chunk_bytes();
 		size_t samples = sound_drv->get_sink_sample_count();
-		uint8_t* buf = new uint8_t[chunk_bytes];
-		if(buf != nullptr) {
-			memset(buf, 0x00, chunk_bytes);
-			int64_t _result = sound_drv->update_sound((void*)buf, samples);
-			delete [] buf;
+		std::unique_ptr<uint8_t[]> buf(new uint8_t[chunk_bytes]);
+		if(buf.get() != nullptr) {
+			memset(buf.get(), 0x00, chunk_bytes);
+			int64_t _result = sound_drv->update_sound((void*)(buf.get()), samples);
 			__LIKELY_IF(_result > 0) {
 				m_sink_empty = false;
 			}
