From 36e43ae85b7a85ca073e0d02c5e755e3226dcf89 Mon Sep 17 00:00:00 2001
From: Magne Sjaastad <magne.sjaastad@ceetronsolutions.com>
Date: Wed, 15 Jun 2022 15:28:32 +0200
Subject: [PATCH] Performance: Move bool outside cell loop

---
 .../RigEclipseNativeVisibleCellsStatCalc.h                 | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/ApplicationLibCode/ReservoirDataModel/RigEclipseNativeVisibleCellsStatCalc.h b/ApplicationLibCode/ReservoirDataModel/RigEclipseNativeVisibleCellsStatCalc.h
index bd20b6f263f..bb8511b9670 100644
--- a/ApplicationLibCode/ReservoirDataModel/RigEclipseNativeVisibleCellsStatCalc.h
+++ b/ApplicationLibCode/ReservoirDataModel/RigEclipseNativeVisibleCellsStatCalc.h
@@ -67,8 +67,9 @@ class RigEclipseNativeVisibleCellsStatCalc : public RigStatisticsCalculator
             return;
         }
 
-        const RigActiveCellInfo* actCellInfo = m_caseData->activeCellInfo();
-        size_t                   cellCount   = actCellInfo->reservoirCellCount();
+        const RigActiveCellInfo* actCellInfo              = m_caseData->activeCellInfo();
+        size_t                   cellCount                = actCellInfo->reservoirCellCount();
+        bool                     isUsingGlobalActiveIndex = m_caseData->isUsingGlobalActiveIndex( m_resultAddress );
 
         CVF_TIGHT_ASSERT( cellCount == m_cellVisibilities->size() );
 
@@ -77,7 +78,7 @@ class RigEclipseNativeVisibleCellsStatCalc : public RigStatisticsCalculator
             if ( !( *m_cellVisibilities )[cIdx] ) continue;
 
             size_t cellResultIndex = cIdx;
-            if ( m_caseData->isUsingGlobalActiveIndex( m_resultAddress ) )
+            if ( isUsingGlobalActiveIndex )
             {
                 cellResultIndex = actCellInfo->cellResultIndex( cIdx );
             }
