From 35916441f72a9048803abddeace28737e80afeb7 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Gunter=20K=C3=B6nigsmann?= <gunter@peterpall.de>
Date: Thu, 13 Feb 2020 12:27:57 +0100
Subject: [PATCH] Further speed up wxMaxima by prioritizing tasks

---
 src/Image.cpp | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/Image.cpp b/src/Image.cpp
index c6b4146727..947a5cd143 100644
--- a/src/Image.cpp
+++ b/src/Image.cpp
@@ -795,11 +795,14 @@ void Image::LoadImage(wxString image, const std::shared_ptr<wxFileSystem> &files
   m_fs_keepalive_imagedata = filesystem;
   // If we don't have fine-grained locking using omp.h we don't profit from sending the
   // load process to the background and therefore load images from the main thread.
+  // Loading images is of rather high priority as they are needed during the
+  // recalculation that follows
   #ifdef HAVE_OMP_HEADER
   wxLogMessage(_("Starting background thread that loads an image"));
   omp_set_lock(&m_imageLoadLock);
   #if HAVE_OPENMP_TASKS
   #pragma omp task
+  #pragma omp prioriy 10
   #endif
   #endif
   LoadImage_Backgroundtask(image, filesystem, remove);
