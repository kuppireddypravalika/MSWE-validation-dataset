From 27694bc3c75da52e8cea20820d1c62df299789ae Mon Sep 17 00:00:00 2001
From: Juli Mallett <juli@clockworksquid.com>
Date: Mon, 3 Jan 2011 22:13:10 +0000
Subject: [PATCH] o) Swap the offsets of sum1 and sum2. o) Use + rather than |
 to allow use with >128-byte segments.

---
 xcodec/xcodec_hash.h | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/xcodec/xcodec_hash.h b/xcodec/xcodec_hash.h
index f163005..f2eaac3 100644
--- a/xcodec/xcodec_hash.h
+++ b/xcodec/xcodec_hash.h
@@ -117,9 +117,9 @@ class XCodecHash {
 	{
 		ASSERT(length_ == XCODEC_SEGMENT_LENGTH);
 
-		uint64_t bits_hash = (bits_.sum2_ << 10) | bits_.sum1_;
-		uint64_t bytes_hash = (bytes_.sum2_ << 15) | bytes_.sum1_;
-		return ((bits_hash << 36) | bytes_hash);
+		uint64_t bits_hash = (bits_.sum1_ << 16) + bits_.sum2_;
+		uint64_t bytes_hash = (bytes_.sum1_ << 20) + bytes_.sum2_;
+		return ((bits_hash << 36) + bytes_hash);
 	}
 
 	static uint64_t hash(const uint8_t *data)
