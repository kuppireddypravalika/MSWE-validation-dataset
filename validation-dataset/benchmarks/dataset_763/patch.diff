From 224e6c9284055131401b35e9eb97a5384acdd83f Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Can=20B=C3=B6l=C3=BCk?= <can.boluk89@gmail.com>
Date: Fri, 31 Jul 2020 03:00:09 +0200
Subject: [PATCH] Improved expression signature hash quality.

---
 VTIL-SymEx/directives/expression_signature.cpp | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/VTIL-SymEx/directives/expression_signature.cpp b/VTIL-SymEx/directives/expression_signature.cpp
index bbc5be64..fbdd6727 100644
--- a/VTIL-SymEx/directives/expression_signature.cpp
+++ b/VTIL-SymEx/directives/expression_signature.cpp
@@ -127,9 +127,9 @@ namespace vtil::symbolic
 
 		// Write hash.
 		//
-		hash_value = make_hash( 
-			( uint8_t ) op,
-			is_commutative ? combine_unordered_hash( lhs.hash(), rhs.hash() ) : combine_hash( lhs.hash(), rhs.hash() ) 
+		hash_value = combine_hash( 
+			is_commutative ? combine_unordered_hash( lhs.hash(), rhs.hash() ) : combine_hash( lhs.hash(), rhs.hash() ),
+			( uint8_t ) op
 		);
 	}
 
