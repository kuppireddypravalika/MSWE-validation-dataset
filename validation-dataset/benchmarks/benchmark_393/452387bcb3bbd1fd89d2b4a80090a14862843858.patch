From 452387bcb3bbd1fd89d2b4a80090a14862843858 Mon Sep 17 00:00:00 2001
From: =?UTF-8?q?Can=20B=C3=B6l=C3=BCk?= <can.boluk89@gmail.com>
Date: Sat, 25 Jul 2020 06:54:41 +0200
Subject: [PATCH] Reserve space for the map.

---
 VTIL-SymEx/simplifier/simplifier.cpp | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/VTIL-SymEx/simplifier/simplifier.cpp b/VTIL-SymEx/simplifier/simplifier.cpp
index 77313b42..70a039c4 100644
--- a/VTIL-SymEx/simplifier/simplifier.cpp
+++ b/VTIL-SymEx/simplifier/simplifier.cpp
@@ -72,7 +72,7 @@ namespace vtil::symbolic
 	// Simplifier cache and its accessors.
 	//
 	static constexpr size_t max_cache_entries = 65536;
-	static constexpr size_t cache_prune_count = max_cache_entries / 4;
+	static constexpr size_t cache_prune_count = max_cache_entries / 2;
 
 	struct local_cache_t
 	{
@@ -173,7 +173,7 @@ namespace vtil::symbolic
 
 		// Cache map.
 		//
-		cache_map map;
+		cache_map map{ max_cache_entries };
 
 		// Resets the local cache.
 		//
@@ -184,6 +184,7 @@ namespace vtil::symbolic
 			spec_list = {};
 			is_speculative = false;
 			map.clear();
+			map.reserve( max_cache_entries );
 		}
 
 		// Begins speculative execution.
