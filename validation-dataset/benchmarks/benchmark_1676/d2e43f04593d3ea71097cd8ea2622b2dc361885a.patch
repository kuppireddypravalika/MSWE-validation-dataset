From d2e43f04593d3ea71097cd8ea2622b2dc361885a Mon Sep 17 00:00:00 2001
From: Kyle Butt <kyle+llvm@iteratee.net>
Date: Sat, 4 Feb 2017 02:26:34 +0000
Subject: [PATCH] [CodeGen]: BlockPlacement: Skip extraneous logging.

Move a check for blocks that are not candidates for tail duplication up before
the logging. Reduces logging noise. No non-logging changes intended.
---
 llvm/lib/CodeGen/MachineBlockPlacement.cpp | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/llvm/lib/CodeGen/MachineBlockPlacement.cpp b/llvm/lib/CodeGen/MachineBlockPlacement.cpp
index 6be20ab6d5a0..8a57f0099751 100644
--- a/llvm/lib/CodeGen/MachineBlockPlacement.cpp
+++ b/llvm/lib/CodeGen/MachineBlockPlacement.cpp
@@ -2215,13 +2215,13 @@ bool MachineBlockPlacement::maybeTailDuplicateBlock(
     BlockChain &Chain, BlockFilterSet *BlockFilter,
     MachineFunction::iterator &PrevUnplacedBlockIt,
     bool &DuplicatedToLPred) {
-
   DuplicatedToLPred = false;
+  if (!shouldTailDuplicate(BB))
+    return false;
+
   DEBUG(dbgs() << "Redoing tail duplication for Succ#"
         << BB->getNumber() << "\n");
 
-  if (!shouldTailDuplicate(BB))
-    return false;
   // This has to be a callback because none of it can be done after
   // BB is deleted.
   bool Removed = false;
