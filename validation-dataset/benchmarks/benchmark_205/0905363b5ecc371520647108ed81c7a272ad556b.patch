From 0905363b5ecc371520647108ed81c7a272ad556b Mon Sep 17 00:00:00 2001
From: Weiqun Zhang <weiqunzhang@lbl.gov>
Date: Fri, 19 Dec 2014 11:53:17 -0800
Subject: [PATCH] moved memory allocation out of OMP parallel region

---
 Src/C_AMRLib/AmrLevel.cpp | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)

diff --git a/Src/C_AMRLib/AmrLevel.cpp b/Src/C_AMRLib/AmrLevel.cpp
index 6307fa99226..c1ed1940e0c 100644
--- a/Src/C_AMRLib/AmrLevel.cpp
+++ b/Src/C_AMRLib/AmrLevel.cpp
@@ -922,14 +922,17 @@ FillPatchIteratorHelper::fill (FArrayBox& fab,
 
         CrseFabs.resize(NC,PArrayManage);
 
+        for (int i = 0; i < NC; i++)
+        {
+            BL_ASSERT(CrseBoxes[i].ok());
+            CrseFabs.set(i, new FArrayBox(CrseBoxes[i],m_ncomp));
+	}
+
 #ifdef _OPENMP
 #pragma omp parallel for
 #endif
         for (int i = 0; i < NC; i++)
         {
-            BL_ASSERT(CrseBoxes[i].ok());
-
-            CrseFabs.set(i, new FArrayBox(CrseBoxes[i],m_ncomp));
             //
             // Set to special value we'll later check
             // to ensure we've filled the FABs at the coarse level.
