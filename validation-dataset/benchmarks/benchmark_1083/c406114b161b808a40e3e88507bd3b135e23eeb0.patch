From c406114b161b808a40e3e88507bd3b135e23eeb0 Mon Sep 17 00:00:00 2001
From: Malachi Burke <malachi.burke@gmail.com>
Date: Tue, 3 May 2022 21:21:31 -0700
Subject: [PATCH] Gotta use vector otherwise it gets optimized out

---
 test/rtos/esp32/stack-diagnostic/main/main.cpp | 5 ++---
 1 file changed, 2 insertions(+), 3 deletions(-)

diff --git a/test/rtos/esp32/stack-diagnostic/main/main.cpp b/test/rtos/esp32/stack-diagnostic/main/main.cpp
index bc62a37f..62d302f2 100644
--- a/test/rtos/esp32/stack-diagnostic/main/main.cpp
+++ b/test/rtos/esp32/stack-diagnostic/main/main.cpp
@@ -37,12 +37,11 @@ void test2()
 {
     static const char* TAG = "test2";
 
-    // FIX: Ok mystery man, why are we not showing stack usage here
-    estd::layer1::vector<uint8_t, 128> v;
+    estd::layer1::vector<uint8_t, 64> v;
 
     v.push_back(5);
 
-    ESP_LOGI(TAG, "sizeof(v)=%u", sizeof(v));
+    ESP_LOGI(TAG, "sizeof(v)=%u, v[0]=%u", sizeof(v), (unsigned)v[0]);
 }
 
 extern "C" void app_main(void)
