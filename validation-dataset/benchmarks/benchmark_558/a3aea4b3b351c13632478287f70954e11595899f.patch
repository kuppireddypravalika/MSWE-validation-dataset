From a3aea4b3b351c13632478287f70954e11595899f Mon Sep 17 00:00:00 2001
From: rkennke <unknown>
Date: Tue, 25 Aug 2020 13:30:02 +0200
Subject: [PATCH] 8222079: Don't use memset to initialize fields decode_env
 constructor in disassembler.cpp Reviewed-by: zgu, andrew

---
 src/share/vm/compiler/disassembler.cpp | 28 ++++++++++++++++----------
 1 file changed, 17 insertions(+), 11 deletions(-)

diff --git a/src/share/vm/compiler/disassembler.cpp b/src/share/vm/compiler/disassembler.cpp
index e7b32cd6b..a0889f1ef 100644
--- a/src/share/vm/compiler/disassembler.cpp
+++ b/src/share/vm/compiler/disassembler.cpp
@@ -244,18 +244,24 @@ class decode_env {
   const char* options() { return _option_buf; }
 };
 
-decode_env::decode_env(CodeBlob* code, outputStream* output, CodeStrings c) {
-  memset(this, 0, sizeof(*this)); // Beware, this zeroes bits of fields.
-  _output = output ? output : tty;
-  _code = code;
-  if (code != NULL && code->is_nmethod())
-    _nm = (nmethod*) code;
-  _strings.copy(c);
-
+decode_env::decode_env(CodeBlob* code, outputStream* output, CodeStrings c) :
+  _nm((code != NULL && code->is_nmethod()) ? (nmethod*)code : NULL),
+  _code(code),
+  _strings(),
+  _output(output ? output : tty),
+  _start(NULL),
+  _end(NULL),
+  _option_buf(),
+  _print_raw(0),
   // by default, output pc but not bytes:
-  _print_pc       = true;
-  _print_bytes    = false;
-  _bytes_per_line = Disassembler::pd_instruction_alignment();
+  _print_pc(true),
+  _print_bytes(false),
+  _cur_insn(NULL),
+  _total_ticks(0),
+  _bytes_per_line(Disassembler::pd_instruction_alignment())
+{
+  memset(_option_buf, 0, sizeof(_option_buf));
+  _strings.copy(c);
 
   // parse the global option string:
   collect_options(Disassembler::pd_cpu_opts());
