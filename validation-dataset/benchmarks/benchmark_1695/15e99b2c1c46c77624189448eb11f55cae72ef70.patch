From 15e99b2c1c46c77624189448eb11f55cae72ef70 Mon Sep 17 00:00:00 2001
From: Marco Inacio <marcoigarapava@gmail.com>
Date: Sat, 25 May 2013 12:13:05 -0300
Subject: [PATCH] Improvement to ordered_logistic distribution: now it uses
 log1m_exp(.) instead of log1m(exp(.)).

---
 .../distributions/univariate/discrete/ordered_logistic.hpp   | 5 +++--
 1 file changed, 3 insertions(+), 2 deletions(-)

diff --git a/src/stan/prob/distributions/univariate/discrete/ordered_logistic.hpp b/src/stan/prob/distributions/univariate/discrete/ordered_logistic.hpp
index d8d3c746dc4..d7eb9ffa472 100644
--- a/src/stan/prob/distributions/univariate/discrete/ordered_logistic.hpp
+++ b/src/stan/prob/distributions/univariate/discrete/ordered_logistic.hpp
@@ -9,6 +9,7 @@
 #include <stan/math/error_handling.hpp>
 #include <stan/math/functions/inv_logit.hpp>
 #include <stan/math/functions/log1m.hpp>
+#include <stan/math/functions/log1m_exp.hpp>
 #include <stan/math/functions/log1p_exp.hpp>
 #include <stan/math/matrix_error_handling.hpp>
 #include <stan/math/error_handling.hpp>
@@ -23,9 +24,9 @@ namespace stan {
     template <typename T>
     inline T log_inv_logit_diff(const T& alpha, const T& beta) {
       using std::exp;
-      using stan::math::log1m;
+      using stan::math::log1m_exp;
       using stan::math::log1p_exp;
-      return beta + log1m(exp(alpha - beta)) - log1p_exp(alpha) - log1p_exp(beta);
+      return beta + log1m_exp(alpha - beta) - log1p_exp(alpha) - log1p_exp(beta);
     }
  
     // y in 0,...,K-1;   c.size()==K-2,  c increasing,  lambda finite
