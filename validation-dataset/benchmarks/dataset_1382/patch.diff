From 74816e1fb93ddac484bb860ac30bb3f4dd58f3e6 Mon Sep 17 00:00:00 2001
From: elsid <elsid@yandex-team.ru>
Date: Thu, 6 Oct 2016 02:29:18 +0300
Subject: [PATCH] Use std::for_each with lambda instead of cycle

Change-Id: Iad0da1298bb98d4ff63adea164417d784ae804e7
---
 include/yamail/resource_pool/async/detail/queue.hpp | 4 +---
 1 file changed, 1 insertion(+), 3 deletions(-)

diff --git a/include/yamail/resource_pool/async/detail/queue.hpp b/include/yamail/resource_pool/async/detail/queue.hpp
index 4253cc6..7e8d79d 100644
--- a/include/yamail/resource_pool/async/detail/queue.hpp
+++ b/include/yamail/resource_pool/async/detail/queue.hpp
@@ -123,9 +123,7 @@ void queue<V, I, T>::cancel(const boost::system::error_code& ec) {
     const lock_guard lock(_mutex);
     const auto begin = _expires_at_requests.begin();
     const auto end = _expires_at_requests.upper_bound(_timer.expires_at());
-    for (auto it = begin; it != end; ++it) {
-        cancel_one(*it);
-    }
+    std::for_each(begin, end, [&] (const request_multimap_value& v) { this->cancel_one(v); });
     _expires_at_requests.erase(_expires_at_requests.begin(), end);
     update_timer();
 }
