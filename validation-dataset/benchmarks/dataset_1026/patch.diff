From d920c510fdd36aa2b2c1821441746e598c349381 Mon Sep 17 00:00:00 2001
From: Jan Blechta <blechta@karlin.mff.cuni.cz>
Date: Tue, 8 Jul 2014 18:59:55 +0200
Subject: [PATCH] Slight optimization of DofMap::dofs()

---
 dolfin/fem/DofMap.cpp | 10 +++-------
 1 file changed, 3 insertions(+), 7 deletions(-)

diff --git a/dolfin/fem/DofMap.cpp b/dolfin/fem/DofMap.cpp
index 93f8853d5db..779d8e06c61 100644
--- a/dolfin/fem/DofMap.cpp
+++ b/dolfin/fem/DofMap.cpp
@@ -364,10 +364,6 @@ std::shared_ptr<GenericDofMap>
 //-----------------------------------------------------------------------------
 std::vector<dolfin::la_index> DofMap::dofs() const
 {
-  // Ownership range
-  const std::size_t r0 = _global_offset;
-  const std::size_t r1 = r0 + _local_ownership_size;
-
   // Create vector to hold dofs
   std::vector<la_index> _dofs;
   _dofs.reserve(_dofmap.size()*max_cell_dimension());
@@ -378,9 +374,9 @@ std::vector<dolfin::la_index> DofMap::dofs() const
   {
     for (std::size_t i = 0; i < cell_dofs->size(); ++i)
     {
-      const std::size_t dof = (*cell_dofs)[i] + r0;
-      if (dof >= r0 && dof < r1)
-        _dofs.push_back(dof);
+      const std::size_t dof = (*cell_dofs)[i];
+      if (dof < _local_ownership_range)
+        _dofs.push_back(dof + _global_offset);
     }
   }
 
