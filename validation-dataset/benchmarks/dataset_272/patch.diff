From cc9fa094d5c218a07de945b302333cce80d550e2 Mon Sep 17 00:00:00 2001
From: Even Rouault <even.rouault@mines-paris.org>
Date: Wed, 6 Dec 2017 19:51:16 +0000
Subject: [PATCH] g2clib: avoid potential int overflow. Fixes
 https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=4547. Credit to OSS
 Fuzz

git-svn-id: https://svn.osgeo.org/gdal/trunk@40969 f0d54148-0727-0410-94bb-9a71ac55c965
---
 gdal/frmts/grib/degrib/g2clib/g2_unpack4.c | 1 +
 1 file changed, 1 insertion(+)

diff --git a/gdal/frmts/grib/degrib/g2clib/g2_unpack4.c b/gdal/frmts/grib/degrib/g2clib/g2_unpack4.c
index d139127513f3..e8a1bff12ed9 100644
--- a/gdal/frmts/grib/degrib/g2clib/g2_unpack4.c
+++ b/gdal/frmts/grib/degrib/g2clib/g2_unpack4.c
@@ -155,6 +155,7 @@ g2int g2_unpack4(unsigned char *cgrib,g2int cgrib_length,g2int *iofst,g2int *ipd
           }
 #endif
           nbits=abs(mappds->ext[j])*8;
+          lipdstmpl[i] = 0;
           if ( mappds->ext[j] >= 0 ) {
             gbit2(cgrib,cgrib_length,lipdstmpl+i,*iofst,nbits);
           }
