From 03461e82a2ae9d81ae7c171282e893a5d4957431 Mon Sep 17 00:00:00 2001
From: gatowololo <gatowololo@gmail.com>
Date: Tue, 15 May 2018 12:52:07 -0400
Subject: [PATCH] Do not read "read" string on every call (too expensive).

---
 src/dettraceSystemCall.cpp | 15 ++++++++-------
 1 file changed, 8 insertions(+), 7 deletions(-)

diff --git a/src/dettraceSystemCall.cpp b/src/dettraceSystemCall.cpp
index 94ea57a3..97c5fe81 100644
--- a/src/dettraceSystemCall.cpp
+++ b/src/dettraceSystemCall.cpp
@@ -659,13 +659,14 @@ void readSystemCall::handleDetPost(globalState& gs, state& s, ptracer& t, schedu
   }
 
   if(bytes_read > 0){
-    char buffer[bytes_read];
-    readVmTracee((void*) t.arg2(), buffer, bytes_read, s.traceePid);
-    gs.log.writeToLog(Importance::extra, "Read output: \"\n");
-    for(int i = 0; i < bytes_read; i++){
-      gs.log.writeToLog(Importance::extra, "%d", (int) buffer[i]);
-    }
-    gs.log.writeToLog(Importance::extra, "\"\n");
+    // This operation is very expensive!
+    // char buffer[bytes_read];
+    // readVmTracee((void*) t.arg2(), buffer, bytes_read, s.traceePid);
+    // gs.log.writeToLog(Importance::extra, "Read output: \"\n");
+    // for(int i = 0; i < bytes_read; i++){
+      // gs.log.writeToLog(Importance::extra, "%d", (int) buffer[i]);
+    // }
+    // gs.log.writeToLog(Importance::extra, "\"\n");
   }
 
   // Replay system call if not enought bytes were read.
