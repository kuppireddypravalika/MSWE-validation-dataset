From 35c04801802cddcf95d9653890687773f09462b9 Mon Sep 17 00:00:00 2001
From: James Yonan <james@openvpn.net>
Date: Wed, 12 Apr 2017 14:07:02 -0600
Subject: [PATCH] AsioTimer: use expires_after() method when possible.

A common AsioTimer usage pattern is:

  expires_at(Time::now() + duration)

This is more succinctly and efficiently stated as:

  expires_after(duration).

Signed-off-by: James Yonan <james@openvpn.net>
---
 openvpn/omi/omi.hpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/openvpn/omi/omi.hpp b/openvpn/omi/omi.hpp
index c4d22b2d7..b7bc7674e 100644
--- a/openvpn/omi/omi.hpp
+++ b/openvpn/omi/omi.hpp
@@ -632,7 +632,7 @@ namespace openvpn {
 
     void stop_omi_client(const bool eof, const unsigned int milliseconds)
     {
-      stop_timer.expires_at(Time::now() + Time::Duration::milliseconds(milliseconds));
+      stop_timer.expires_after(Time::Duration::milliseconds(milliseconds));
       stop_timer.async_wait([self=Ptr(this), eof](const openvpn_io::error_code& error)
 				 {
 				   if (!error)
