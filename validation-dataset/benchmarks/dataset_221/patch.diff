From 1d825fcc204c90f31123f9edd38a41163c796220 Mon Sep 17 00:00:00 2001
From: James Yonan <james@openvpn.net>
Date: Wed, 5 Mar 2014 20:19:48 -0700
Subject: [PATCH] When setting DNS servers on Windows, use netsh option
 "register=primary".  This appears to improve DNS responsiveness.

---
 openvpn/tun/win/client/tuncli.hpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/openvpn/tun/win/client/tuncli.hpp b/openvpn/tun/win/client/tuncli.hpp
index d46e819b8..5700a4e0f 100644
--- a/openvpn/tun/win/client/tuncli.hpp
+++ b/openvpn/tun/win/client/tuncli.hpp
@@ -439,7 +439,7 @@ namespace openvpn {
 		create.add(new WinCmd("netsh interface " + proto + " add dnsservers " + tap_index_name + ' ' + ds.address + " " + to_string(idx+1) + " validate=no"));
 	      else
 		{
-		  create.add(new WinCmd("netsh interface " + proto + " set dnsservers " + tap_index_name + " static " + ds.address + " register=none validate=no"));
+		  create.add(new WinCmd("netsh interface " + proto + " set dnsservers " + tap_index_name + " static " + ds.address + " register=primary validate=no"));
 		  destroy.add(new WinCmd("netsh interface " + proto + " delete dnsservers " + tap_index_name + " all validate=no"));
 		}
 	    }
