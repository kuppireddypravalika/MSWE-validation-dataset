From ea711d0f59d6272f14b61cb2fd3dc1ede2cc1eb6 Mon Sep 17 00:00:00 2001
From: Anton Kudryavtsev <a.kudryavtsev@netris.ru>
Date: Sat, 20 Feb 2016 11:57:23 +0300
Subject: [PATCH] QPlatformWindow: don't call QScreen::virtualSiblings()

... when QT_NO_CURSOR is enabled. Then, result of this
function is unneeded.

Change-Id: I0e74e1aa5253de2608c4c18cb2c4b4e2e9f4c9e2
Reviewed-by: Friedemann Kleint <Friedemann.Kleint@theqtcompany.com>
---
 src/gui/kernel/qplatformwindow.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/gui/kernel/qplatformwindow.cpp b/src/gui/kernel/qplatformwindow.cpp
index 769d30888bfc..1d444f94c911 100644
--- a/src/gui/kernel/qplatformwindow.cpp
+++ b/src/gui/kernel/qplatformwindow.cpp
@@ -552,8 +552,8 @@ static inline const QScreen *effectiveScreen(const QWindow *window)
     const QScreen *screen = window->screen();
     if (!screen)
         return QGuiApplication::primaryScreen();
-    const QList<QScreen *> siblings = screen->virtualSiblings();
 #ifndef QT_NO_CURSOR
+    const QList<QScreen *> siblings = screen->virtualSiblings();
     if (siblings.size() > 1) {
         const QPoint referencePoint = window->transientParent() ? window->transientParent()->geometry().center() : QCursor::pos();
         for (const QScreen *sibling : siblings) {
