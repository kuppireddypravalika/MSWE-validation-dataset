From 6c0ad4ffcfe331fd8326a67e05c4e9aa1b949cd6 Mon Sep 17 00:00:00 2001
From: Filip Jeremic <fjeremic@ca.ibm.com>
Date: Wed, 24 Jul 2019 14:11:11 -0400
Subject: [PATCH] Simplify XPLINKCallDescriptorRelocation calculation

Use the already calculated offsetToCallDescriptor instead of
recalculating it again.

Signed-off-by: Filip Jeremic <fjeremic@ca.ibm.com>
---
 compiler/z/codegen/SystemLinkagezOS.cpp | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/compiler/z/codegen/SystemLinkagezOS.cpp b/compiler/z/codegen/SystemLinkagezOS.cpp
index bd668d313f..db5605d067 100644
--- a/compiler/z/codegen/SystemLinkagezOS.cpp
+++ b/compiler/z/codegen/SystemLinkagezOS.cpp
@@ -1028,5 +1028,5 @@ TR::S390zOSSystemLinkage::XPLINKCallDescriptorRelocation::apply(TR::CodeGenerato
       }
 
    uint8_t* p = getUpdateLocation();
-   *reinterpret_cast<int16_t*>(p) = static_cast<int16_t>(getLabel()->getCodeLocation() - (_nop->getBinaryEncoding() - 7)) / 8;
+   *reinterpret_cast<int16_t*>(p) = static_cast<int16_t>(offsetToCallDescriptor);
    }
