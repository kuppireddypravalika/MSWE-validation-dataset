From 4cecdc9be5651831fefcd37c0c0e8ef03642274c Mon Sep 17 00:00:00 2001
From: akolliasAMD <99202231+akolliasAMD@users.noreply.github.com>
Date: Wed, 3 Aug 2022 15:07:44 -0600
Subject: [PATCH] minor latency tuning (#591)

* minor tuning for tree ll
---
 src/enqueue.cc | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/src/enqueue.cc b/src/enqueue.cc
index 2dfaa1303..12281cb40 100644
--- a/src/enqueue.cc
+++ b/src/enqueue.cc
@@ -464,11 +464,11 @@ static ncclResult_t getAlgoInfo(struct ncclInfo* info, int collNetTypeSupport, i
     info->nChannels = nc;
     if (!userTuneInput) {
       // always respect user settings
-      if (info->nBytes <= 196608) {
+      if (info->nBytes <= 900000) {
         info->protocol = NCCL_PROTO_LL;
         info->algorithm = NCCL_ALGO_TREE;
-        info->nChannels =  std::min(comm->nChannels, info->nBytes <= 65536? 4 : 12);
-      } else if (info->nBytes <= 1048576) {
+        info->nChannels = std::min(comm->nChannels, info->nBytes <= 16384? 4 : 24);
+      } else if (info->nBytes <= 2200008) {
         info->protocol = NCCL_PROTO_LL;
         info->algorithm = NCCL_ALGO_RING;
       } else {
