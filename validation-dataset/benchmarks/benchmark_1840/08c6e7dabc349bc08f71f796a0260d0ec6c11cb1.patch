From 08c6e7dabc349bc08f71f796a0260d0ec6c11cb1 Mon Sep 17 00:00:00 2001
From: pernet <pernet@dda9dfc7-2772-4c6c-972d-d99ad1e2f97f>
Date: Mon, 1 Jun 2015 17:01:45 +0000
Subject: [PATCH] smaller maxModulus for ModularBalanced<int64_t>, as use of
 igemm requires a field element to fit in a 31 bit mantissa. See FFLAS-FFPACK
 ticket #20.

---
 src/kernel/ring/modular-balanced-int64.h | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/src/kernel/ring/modular-balanced-int64.h b/src/kernel/ring/modular-balanced-int64.h
index 6eb38fdc..f45e02d9 100644
--- a/src/kernel/ring/modular-balanced-int64.h
+++ b/src/kernel/ring/modular-balanced-int64.h
@@ -405,9 +405,11 @@ namespace Givaro
 		static inline Element getMaxModulus()
 		{
 #ifdef __x86_64__
-			return 6074000999L; // s.t. 2((p-1)/2)^2 < 2^64
+			return 4294967296L;  // s.t. (p-1)/2 < 2^31 (a field element need to fit on a signed 32 bits int for the SIMD instruction _mm_mul_epi32)
+			    //return 6074000999L; // s.t. (p-1)/2 < 2^31
 #else
-			return 6074000999LL;
+			return 4294967296LL;
+//			return 6074000999LL;
 #endif
 		}
 
